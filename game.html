<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UMNLife</title>
	<link rel="icon" type="image/x-icon" href="favicon.ico">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body onload="startTime();">
	<div class="container" id="container">
		<div class="header-nav">
			<button onclick="closeFullscreen();"><img class="logo" src="image/icons/subtract.png"></button>
			<button onclick="openFullscreen();"><img class="logo" src="image/icons/maximize.png"></button>
			<a href="index.html"><img class="logo" src="image/icons/close.png"></a>
		</div>

		<div class="header text-center">
			<img class="logo" src="image/logo.png" style="text-align: center;">
			<h2 class="header-title mt-2 mb-3">UMNLife</h2>		
		</div>

		<div class="container-fluid game-status mt-3">
            <div class="row">
                <div class="col-md-4">
                    <label for="progress-eat"><img src="image/icons/eat.png"></label>
                    <progress id="progress-eat" value="5" max="10" data-toggle="tooltip" data-placement="top" title="Progress Makan"></progress>
                </div>
                <div class="col-md-4">
                    <label for="progress-sleep"><img src="image/icons/sleep.png"></label>
                    <progress id="progress-sleep" value="5" max="10" data-toggle="tooltip" data-placement="top" title="Progress Tidur"></progress>
                </div>
                <div class="col-md-4">
                    <label for="progress-play"><img src="image/icons/play.png"></label>
                    <progress id="progress-play" value="5" max="10" data-toggle="tooltip" data-placement="top" title="Progress Bermain"></progress>
                </div>
                <div class="col-md-4">
                    <label for="progress-study"><img src="image/icons/study.png"></label>
                    <progress id="progress-study" value="0" max="10" data-toggle="tooltip" data-placement="top" title="Progress Belajar"></progress>
                </div>
                <div class="col-md-4">
                    <label for="progress-healthy"><img src="image/icons/healthy.png"></label>
                    <progress id="progress-healthy" value="5" max="10" data-toggle="tooltip" data-placement="top" title="Progress Kesehatan"></progress>
                </div>
                <div class="col-md-4">
                    <label for="progress-drink"><img src="image/icons/drink.png"></label>
                    <progress id="progress-drink" value="5" max="10" data-toggle="tooltip" data-placement="top" title="Progress Minum"></progress>
                </div>
                <div class="col-md-12 text-center">
                    <h4>Semester <span id="player-semester">1</span></h4>
                </div>
            </div>
        </div>

        <div class="container-fluid player-section mb-2 mt-2 text-center">
            <h5><span id="playerGreet"></span><span id="player-name"></span></h5>
            <input type="text" id="player-gender" style="display: none;">
            <div id="time"></div>
            <img id="player-character" class="game-character">
        </div>

        <div class="container-fluid player-activities text-center">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <button id="btn-1" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#foodModal">Makan <img src="image/icons/eat.png"></button>
                </div>
                <div class="col-md-4 mb-3">
                    <button id="btn-2" class="btn btn-primary" onclick="sleeping(); setTimeout(playerSleep, 5300); btnDisabled();">Tidur <img src="image/icons/sleep.png"></button>
                </div>
                <div class="col-md-4 mb-3">
                    <button id="btn-3" class="btn btn-primary" onclick="playing(); setTimeout(playerPlay, 4200); btnDisabled();">Main <img src="image/icons/play.png"></button>
                </div>
                <div class="col-md-4 mb-2">
                    <button id="btn-4" class="btn btn-primary" onclick="studying(); setTimeout(playerStudy, 5000); btnDisabled();">Belajar <img src="image/icons/study.png"></button>
                </div>
                <div class="col-md-4 mb-2">
                    <button id="btn-5" class="btn btn-primary" onclick="visiting(); setTimeout(playerHealthy, 4200); btnDisabled();">Sehat <img src="image/icons/healthy.png"></button>
                </div>
                <div class="col-md-4 mb-2">
                    <button id="btn-6" class="btn btn-primary" onclick="drinking(); setTimeout(playerDrink, 1000); btnDisabled();">Minum <img src="image/icons/drink.png"></button>
                </div>
            </div>
        </div>

        <div class="sound">
			<button class="btn-sound play-music" data-toggle="tooltip" data-placement="top" title="Play music"><img id="audio" src="image/icons/audiooff.png"></button>
        </div>

        <div class="modal fade" id="foodModal" role="dialog">
        	<div class="modal-dialog">
        		 <div class="modal-content">
        		 	<div class="modal-header">
        		 		<h3 class="modal-title text-center">Pilih makanan</h3>
        		 		<button type="button" class="close" data-bs-dismiss="modal">&times;</button>
        		 	</div>
        		 	<div class="modal-body">
        		 		<div class="row text-center">
        		 			<div class="col-md-4">
        		 				<img src="image/rice.png" width="100">
        		 				<button id="btn-1menu" class="btn btn-primary mt-3" onclick="eating(); setTimeout(playerEat1, 4500); btnDisabled();">Nasi + Lauk</button>
        		 			</div>
        		 			<div class="col-md-4">
        		 				<img src="image/snack.png" width="100">
        		 				<button id="btn-2menu" class="btn btn-primary mt-3" onclick="eating(); setTimeout(playerEat2, 2500); btnDisabled();">Snack</button>
        		 			</div>
        		 			<div class="col-md-4">
        		 				<img src="image/apple.png" width="100">
        		 				<button id="btn-3menu" class="btn btn-primary mt-3" onclick="eating(); setTimeout(playerEat3, 4000); btnDisabled();">Buah</button>
        		 			</div>
        		 		</div>
        		 	</div>
        		 	<div class="modal-footer">
        		 		<button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
        		 	</div>
        		 </div>
        	</div>
        </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.1/howler.min.js" integrity="sha512-L6Z/YtIPQ7eU3BProP34WGU5yIRk7tNHk7vaC2dB1Vy1atz6wl9mCkTPPZ2Rn1qPr+vY2mZ9odZLdGYuaBk7dQ==" crossorigin="anonymous"></script>
<script>
	// Script header-nav
	var elem = document.documentElement;
	function openFullscreen() {
		if (elem.requestFullscreen) {
			elem.requestFullscreen();
		} else if (elem.webkitRequestFullscreen) { /* Safari */
			elem.webkitRequestFullscreen();
		} else if (elem.msRequestFullscreen) { /* IE11 */
			elem.msRequestFullscreen();
		}
	}

	function closeFullscreen() {
		if (document.exitFullscreen) {
			document.exitFullscreen();
		} else if (document.webkitExitFullscreen) { /* Safari */
			document.webkitExitFullscreen();
		} else if (document.msExitFullscreen) { /* IE11 */
			document.msExitFullscreen();
		}
	}

	var music = {
		overworld: new Howl ({
			src: [
				"bgm.mp3"
			]
		})
	}

	document.querySelector(".play-music").addEventListener("click", () => {
	if (!music.overworld.playing()) {
			document.getElementById("audio").src = "image/icons/audioon.png";
			music.overworld.play();
		} else if (music.overworld.playing()) {
			document.getElementById("audio").src = "image/icons/audiooff.png";
			music.overworld.pause();
		}
	})
</script>
<script>
	// Tooltip
	$(function () {
		$('[data-toggle="tooltip"]').tooltip()
	})

	// Close after eat
	$('#btn-1menu, #btn-2menu, #btn-3menu').click(function() {
		$('#foodModal').modal('hide');
	});

	// Get name and character from localStorage
	document.getElementById("player-name").innerHTML = name + "!";
	document.getElementById("player-gender").value = localStorage.getItem("gender");

	var characterGender = document.getElementById("player-gender").value;
	if (characterGender == "boy") {
		document.getElementById("player-character").src = "image/boy.png";
	} else if (characterGender == "girl") {
		document.getElementById("player-character").src = "image/girl.png";
	}

	// Time
	const clock = document.getElementById("time");
	var getTime = new Date();
	var hour = getTime.getHours();
	var minute = getTime.getMinutes();
	var stopTime = true;

	function startTime() {
		minute = parseInt(minute);
		hour = parseInt(hour);
		minute = minute + 1;

		if (minute == 60) {
			hour = hour + 1;
			minute = 0;
		}

		if (minute < 10 || minute == 0) {
			minute = '0' + minute;
		}

		if (hour < 10 || hour == 0) {
			hour = '0' + hour;
		}

		if (hour > 23) {
			hour = '00';
		}

		clock.innerHTML = "<h3>" + hour + ":" + minute + "</h3>";
		setTimeout("startTime()", 1000);
	}

	// Greeting
	$(document).ready(function() {
		function playerGreet() {
			if (hour < 5) {
				$("#playerGreet").html("Selamat Malam, ");
				document.body.style.background = "url(image/malam.png) no-repeat right";
			} else if (hour < 10) {
				$("#playerGreet").html("Selamat Pagi, ");
				document.body.style.background = "url(image/pagi.png) no-repeat right";
			} else if (hour < 15) {
				$("#playerGreet").html("Selamat Siang, ");
				document.body.style.background = "url(image/siang.png) no-repeat right";
			} else if (hour < 19) {
				$("#playerGreet").html("Selamat Sore, ");
				document.body.style.background = "url(image/sore.png) no-repeat right";
			} else {
				$("#playerGreet").html("Selamat Malam, ");
				document.body.style.background = "url(image/malam.png) no-repeat right";
			}
		}		
		setInterval(playerGreet, 0);
	});

    // -----------------------------------------------------------------------

    // Function makan
	function eating() {
		if (characterGender == "boy") {
			document.getElementById("player-character").src = "image/eating-boy.png"
		} else {
			document.getElementById("player-character").src = "image/eating-girl.png"
		}
	}

	// Makan 1 - nasi + lauk
	function playerEat1() {	
		document.getElementById("progress-eat").value += 5;
		document.getElementById("progress-sleep").value -= 0.2;
		document.getElementById("progress-play").value -= 0.2;
		document.getElementById("progress-study").value -= 0.2;
		document.getElementById("progress-drink").value -= 0.2;
		document.getElementById("progress-healthy").value += 1;

		btnEnabled();
		defaultCharacter();
	}

	// Makan 2 = snack
	function playerEat2() {	
		document.getElementById("progress-eat").value += 2.5;
		document.getElementById("progress-sleep").value -= 0.1;
		document.getElementById("progress-play").value -= 0.1;
		document.getElementById("progress-study").value -= 0.1;
		document.getElementById("progress-drink").value -= 0.1;
		document.getElementById("progress-healthy").value += 1;

		btnEnabled();
		defaultCharacter();
	}

	// Makan 3 = buah
	function playerEat3() {	
		document.getElementById("progress-eat").value += 3.7;
		document.getElementById("progress-sleep").value -= 0.1;
		document.getElementById("progress-play").value -= 0.1;
		document.getElementById("progress-study").value -= 0.1;
		document.getElementById("progress-drink").value -= 0.1;
		document.getElementById("progress-healthy").value += 1.3;

		btnEnabled();
		defaultCharacter();
	}
	setInterval(needEat, 15000);
	function needEat() {
		document.getElementById("progress-eat").value -= 0.37;

		if (document.getElementById("progress-eat").value > 0 && document.getElementById("progress-eat").value <= 1) {
			window.alert("Lapar ya? Makan yuk!");
		} else if (document.getElementById("progress-eat").value == 0) {
			window.location.reload();
			alert("Game Over! Karakter anda mati karena kelaparan :(");
		}
	}

	// Function tidur
	function sleeping() {
		if (characterGender == "boy") {
			document.getElementById("player-character").src = "image/sleeping-boy.png"
		} else {
			document.getElementById("player-character").src = "image/sleeping-girl.png"
		}
	}

	function playerSleep() {
		document.getElementById("progress-eat").value -= 0.3;
		document.getElementById("progress-sleep").value += 5;
		document.getElementById("progress-play").value -= 0.3;
		document.getElementById("progress-study").value -= 0.3;
		document.getElementById("progress-drink").value -= 0.3;
		document.getElementById("progress-healthy").value += 2;

		btnEnabled();
		defaultCharacter();
	}
	setInterval(needSleep, 20000);
	function needSleep() {
		document.getElementById("progress-sleep").value -= 0.4;

		if (document.getElementById("progress-sleep").value > 0 && document.getElementById("progress-sleep").value <=1) {
			window.alert("Capek? Istirahat dulu yahhh!");
		} else if (document.getElementById("progress-sleep").value == 0) {
			alert("Kamu terlalu capek hingga tertidur!");
			sleeping();
			setTimeout(playerSleep, 6300); 
			btnDisabled();
		}
	}

	// Function main
	function playing() {
		document.getElementById("player-character").src = "image/playing.png";
	}

	function playerPlay() {
		document.getElementById("progress-eat").value -= 0.3;
		document.getElementById("progress-sleep").value -= 0.3;
		document.getElementById("progress-play").value += 5;
		document.getElementById("progress-study").value -= 0.3;
		document.getElementById("progress-drink").value -= 0.3;
		document.getElementById("progress-healthy").value -= 1;

		btnEnabled();
		defaultCharacter();
	}
	setInterval(needPlay, 12000);
	function needPlay() {
		document.getElementById("progress-play").value -= 0.3;

		if (document.getElementById("progress-play").value <=1) {
			window.alert("Bosan? Main dulu yuk!");
		}
	}

	// Function belajar
	function studying() {
		if (characterGender == "boy") {
			document.getElementById("player-character").src = "image/studying-boy.png"
		} else {
			document.getElementById("player-character").src = "image/studying-girl.png"
		}
	}

	function playerStudy() {
		document.getElementById("progress-eat").value -= 0.3;
		document.getElementById("progress-sleep").value -= 0.3;
		document.getElementById("progress-play").value -= 0.3;
		document.getElementById("progress-study").value += 2.5;
		document.getElementById("progress-drink").value -= 0.3;
		document.getElementById("progress-healthy").value -= 0.3;

		btnEnabled();
		defaultCharacter();

		var semester = document.getElementById("player-semester").innerHTML;
		if (document.getElementById("progress-study").value >= 10) {
			var newSemester = parseInt(semester, 10) + 1;

			if (newSemester > 8) {
				window.location.href = "index.html";
				window.alert("Selamat kamu telah lulus dari Universitas Multimedia Nusantara! Kamu akan kembali ke halaman utama dan terima kasih telah bermain!");
			} else {
				document.getElementById("player-semester").innerHTML = newSemester;
				window.alert("Selamat kamu telah menyelesaikan semester sebelumnya! Sekarang kamu naik ke semester " + newSemester);
				document.getElementById("progress-study").max += 1;
				document.getElementById("progress-study").value = 0;	
			}
		}
	}
	setInterval(needStudy, 60000);
	function needStudy() {
		document.getElementById("progress-study").value -= 0.35;

		if (document.getElementById("progress-study").value <= 1) {
			window.alert("Udah lama gak belajar nih, belajar yuk!");
		}
	}

	
	// Function kesehatan
	function visiting() {
		if (characterGender == "boy") {
			document.getElementById("player-character").src = "image/visiting-boy.png"
		} else {
			document.getElementById("player-character").src = "image/visiting-girl.png"
		}
	}

	function playerHealthy() {
		document.getElementById("progress-eat").value -= 0.3;
		document.getElementById("progress-sleep").value -= 0.3;
		document.getElementById("progress-play").value -= 0.3;
		document.getElementById("progress-study").value -= 0.3;
		document.getElementById("progress-drink").value -= 0.3;
		document.getElementById("progress-healthy").value += 4;

		btnEnabled();
		defaultCharacter();
	}
	setInterval(needHealthy, 40000)
	function needHealthy() {
		document.getElementById("progress-healthy").value -= 0.5;

		if (document.getElementById("progress-healthy").value > 0 && document.getElementById("progress-healthy").value <= 1) {
			window.alert("Kamu sakit! Segera kunjungi dokter!");
		} else if (document.getElementById("progress-healthy").value == 0) {
			window.location.reload();
			alert("Game Over! Karakter anda mati karena sakit :(");
		}
	}

	// Function haus
	function drinking() {
		if (characterGender == "boy") {
			document.getElementById("player-character").src = "image/drinking-boy.png"
		} else {
			document.getElementById("player-character").src = "image/drinking-girl.png"
		}
	}

	function playerDrink() {	
		document.getElementById("progress-play").value -= 0.3;
		document.getElementById("progress-study").value -= 0.3;
		document.getElementById("progress-healthy").value += 0.5;
		document.getElementById("progress-drink").value += 4;

		btnEnabled();
		defaultCharacter();
	}
	setInterval(needDrink, 11000);
	function needDrink() {
		document.getElementById("progress-drink").value -= 0.4;
		document.getElementById("progress-healthy").value -= 0.3;
		document.getElementById("progress-study").value -= 0.2;

		if (document.getElementById("progress-drink").value <= 1) {
			window.alert("Minum dulu yuk biar tidak dehidrasi!");
		}
	}

	// --------------------------------------------------------------------------

	function defaultCharacter() {
		document.getElementById("player-character").src = "image/" + characterGender + ".png";
	}
	
	function btnEnabled() {
		document.getElementById("btn-1").disabled = false;
		document.getElementById("btn-2").disabled = false;
		document.getElementById("btn-3").disabled = false;
		document.getElementById("btn-4").disabled = false;
		document.getElementById("btn-5").disabled = false;
		document.getElementById("btn-6").disabled = false;
	}

	function btnDisabled() {
		document.getElementById("btn-1").disabled = true;
		document.getElementById("btn-2").disabled = true;
		document.getElementById("btn-3").disabled = true;
		document.getElementById("btn-4").disabled = true;
		document.getElementById("btn-5").disabled = true;
		document.getElementById("btn-6").disabled = true;
	}

</script>
</html>